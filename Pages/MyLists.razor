@page "/MyLists"
@using Services;
@using Data;
@inject ListHandler listHandler;
@inject NavigationManager manager;



<table>

    <thead>
        <h1>Mina listor</h1>
    </thead>

    <tbody>
        @foreach (var list in lists)
        {
        <button @onclick="@(async () => await GetList(list))" class="btn-medium">@list.ListTitle</button>
        <button @onclick="@(async () => await DeleteList(list))" class="btn-small">Ta bort lista</button><br />
        }
    </tbody>
    <button @onclick="@(async () => await CreateNewList())" class="btn-small">Skapa ny lista</button>
</table>


@code {

    public IEnumerable<CreateToDoList> lists = new List<CreateToDoList>();

    public async System.Threading.Tasks.Task DeleteList(CreateToDoList list)
    {
        await listHandler.DeleteList(list);
        lists = await listHandler.GetCurrentUserListsAsync();
    }

    public async System.Threading.Tasks.Task GetList(CreateToDoList list)
    {
        manager.NavigateTo($"/ShowList/{list.Id.ToString()}");
    }

    protected override async System.Threading.Tasks.Task OnInitializedAsync()
    {
        lists = await listHandler.GetCurrentUserListsAsync();
    }

    public async System.Threading.Tasks.Task CreateNewList()
    {
        manager.NavigateTo($"/CreateNewToDoList");
    }
}